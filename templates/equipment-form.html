{% extends "base.html" %}

{% block title %}{{ form_title }}{% endblock %}

{% block content %}
<h1>{{ form_title }}</h1>

{% for error in form.non_field_errors %}
    <div class="flash error">{{ error }}</div>
{% endfor %}

<form method="POST" enctype="multipart/form-data" class="equipment-form">
    {{ form.hidden_tag() }}

    <div class="form-group">
        {{ form.name.label }}
        {# Добавляем класс is-invalid, если есть ошибки #}
        {{ form.name(class="form-control" + (" is-invalid" if form.name.errors else "")) }}
        {% for error in form.name.errors %}
            <span class="error-feedback">{{ error }}</span>
        {% endfor %}
    </div>

    <div class="form-group">
        {{ form.inventory_number.label }}
        {{ form.inventory_number(class="form-control" + (" is-invalid" if form.inventory_number.errors else "")) }}
        {% for error in form.inventory_number.errors %}
            <span class="error-feedback">{{ error }}</span>
        {% endfor %}
    </div>

    <div class="form-group">
        {{ form.category_id.label }}
        {{ form.category_id(class="form-control" + (" is-invalid" if form.category_id.errors else "")) }}
        {% for error in form.category_id.errors %}
            <span class="error-feedback">{{ error }}</span>
        {% endfor %}
    </div>

    <div class="form-group">
        {{ form.purchase_date.label }}
        {{ form.purchase_date(class="form-control" + (" is-invalid" if form.purchase_date.errors else "")) }}
        {% for error in form.purchase_date.errors %}
            <span class="error-feedback">{{ error }}</span>
        {% endfor %}
    </div>

    <div class="form-group">
        {{ form.cost.label }}
        {{ form.cost(class="form-control" + (" is-invalid" if form.cost.errors else "")) }}
        {% for error in form.cost.errors %}
            <span class="error-feedback">{{ error }}</span>
        {% endfor %}
    </div>

    <div class="form-group">
        {{ form.status.label }}
        <div class="radio-group {{ "is-invalid" if form.status.errors else "" }}">
            {{ form.status() }}
        </div>
        {% for error in form.status.errors %}
            <span class="error-feedback">{{ error }}</span>
        {% endfor %}
    </div>

    <div class="form-group">
        {{ form.note.label }}
        {{ form.note(class="form-control" + (" is-invalid" if form.note.errors else ""), rows=4) }}
        {% for error in form.note.errors %}
            <span class="error-feedback">{{ error }}</span>
        {% endfor %}
    </div>

    <div class="form-group">
        {{ form.photo.label }}
        {{ form.photo(class="form-control-file" + (" is-invalid" if form.photo.errors else "")) }}
        {% for error in form.photo.errors %}
            <span class="error-feedback">{{ error }}</span>
        {% endfor %}
    </div>
    
    <div class="form-group">
        {{ form.submit(class="btn btn-primary") }}
    </div>
</form>

<style>
    .form-group { margin-bottom: 1rem; }
    .form-control, .form-control-file, .radio-group { width: 100%; padding: 0.5rem; box-sizing: border-box; }
    .error-feedback { color: red; font-size: 0.875em; }
    .is-invalid { border-color: red; }
</style>
{% endblock %}